import os

DATA_PATH = "./data/integration"
fields = ["id", "카테고리", "주요업무", "자격요건", "우대사항", "복리후생", "제목", "기업명", "지역", "산업", "근무형태", "경력",
          "학력", "급여", "키워드"]

category = []
major_task = []
qualification = []
prefer_treatment = []
benefit = []
title = []
company = []
location = []
industry = []
job_type = []
career = []
education = []
salary = []
keyword = []
category_mapping = {
    '기획·전략·경영': 0,
    '경영지원': 0,
    '경영기획/전략': 0,
    '조직문화': 0,
    '마케팅·광고·분석': 1,
    '마케팅': 1,
    '전략마케팅': 1,
    '제품별마케팅': 1,
    '마케팅커뮤니케이션': 1,
    '온라인마케팅': 1,
    'CRM': 1,
    '브랜드마케팅': 1,
    '시장조사/분석': 1,
    '홍보·PR·사보': 2,
    '브랜드디자인': 2,
    '대외협력': 2,
    '홍보': 2,
    '경리·출납·결산': 3,
    '경리/출납/결산': 3,
    '회계·재무·세무·IR': 4,
    '감사': 4,
    '총무·법무·사무': 5,
    '총무/사무': 5,
    '비서·안내·수행원': 6,
    '의전': 6,
    '비서/안내/수행원': 6,
    '인사·교육·노무': 7,
    '인사관리': 7,
    '인재개발/교육': 7,
    '채용': 7,
    '노무': 7,
    '보상': 7,
    '사무보조·문서작성': 8,
    '사무보조/문서작성': 8,
    '전시·컨벤션·세미나': 9,
    '리셉션': 9,
    '일반영업': 10,
    '국내영업': 10,
    '의약영업': 10,
    '영업기획·관리·지원': 11,
    '영업기획/관리/지원': 11,
    '기술영업': 12,
    'IT·솔루션영업': 13,
    'IT/솔루션영업': 13,
    '광고영업': 14,
    '금융·보험영업': 15,
    '금융/보험영업': 15,
    '자산운용가': 15,
    '판매·매장관리': 16,
    '판매/매장관리': 16,
    'TM·아웃바운드': 17,
    '텔레마케팅': 17,
    'TM·인바운드': 18,
    '고객센터·CS': 19,
    '고객지원/CS': 19,
    '고객지원/Desk': 19,
    'QA·CS강사·수퍼바이저': 20,
    '기타 서비스직': 20,
    '웹개발': 21,
    '응용프로그램개발': 22,
    '모바일앱개발': 22,
    '시스템개발': 23,
    '시스템엔지니어': 23,
    '서버·네트워크·보안': 24,
    '네트워크/보안/운영': 24,
    'ERP·시스템분석·설계': 25,
    'ERP': 25,
    '데이터베이스·DBA': 26,
    'DBA(Database Admin.)': 26,
    '퍼블리싱·UI개발': 27,
    '웹퍼블리셔': 27,
    '웹디자인': 28,
    'UI/UX/GUI디자인': 28,
    '하드웨어·소프트웨어': 29,
    '소프트웨어엔지니어': 29,
    '하드웨어엔지니어': 29,
    '소프트웨어아키텍트': 29,
    '통신·모바일': 30,
    '웹기획·PM': 31,
    '기획': 31,
    '웹마스터·QA·테스터': 32,
    'QA(Quality Assurance)': 32,
    '컨텐츠·사이트운영': 33,
    '프로젝트매니저': 33,
    '게임·Game': 34,
    '게임개발': 34,
    'IT·디자인·컴퓨터교육': 35,
    '동영상·편집·코덱': 36,
    '영상/모션디자인': 36,
    '인공지능(AI)·빅데이터': 37,
    '데이터분석': 37,
    '그래픽디자인·CG': 38,
    '그래픽디자인': 38,
    '일러스트레이터': 38,
    '출판·편집디자인': 39,
    '출판/편집디자인': 39,
    '폰트디자인': 39,
    '제품·산업디자인': 40,
    '제품/산업디자인': 40,
    '금속/공예디자인': 40,
    '캐릭터·만화·애니': 41,
    '캐릭터디자인': 41,
    '애니메이션디자인': 41,
    '의류·패션·잡화디자인': 42,
    '패션/섬유디자인': 42,
    '전시·공간디자인': 43,
    '전시/무대디자인': 43,
    '환경/조경디자인': 43,
    '광고·시각디자인': 44,
    '광고/시각디자인': 44,
    '디자인기타': 45,
    '웨딩·행사·이벤트': 46,
    '웨딩플래너/커플매니저': 46,
    '안내·도우미·나레이터': 47,
    '보안·경호·안전': 48,
    '경호/경비원': 48,
    '주차·세차·주유': 49,
    'AS·서비스·수리': 50,
    '유지/수리/정비': 50,
    '외식·식음료': 51,
    '외식업/식음료': 51,
    '호텔·카지노·콘도': 52,
    '호텔리어': 52,
    '여행·관광·항공': 53,
    '스튜어디스/승무원': 53,
    '여행가이드': 53,
    '항공기조종사/항해사': 53,
    '레저·스포츠': 54,
    '미용·피부관리·애견': 55,
    '뷰티/미용': 55,
    '요리·제빵사·영양사': 56,
    '요리사/푸드스타일리스트': 56,
    '제과제빵사': 56,
    '가사·청소·육아': 57,
    '경영분석·컨설턴트': 58,
    '컨설팅': 58,
    '증권·투자·펀드·외환': 59,
    '증권/투자분석가': 59,
    '외환/국제금융/펀드매니저': 59,
    '은행원': 59,
    '설문·통계·리서치': 60,
    '헤드헌팅·노무·직업상담': 61,
    '헤드헌터': 61,
    '상담사': 61,
    '외국어·번역·통역': 62,
    '통역/번역': 62,
    '법률·특허·상표': 63,
    '변호사': 63,
    '법률/법무': 63,
    '특허/변리사': 63,
    '세무·회계·CPA': 64,
    '재무기획/재무분석': 64,
    '회계사': 64,
    '세무사': 64,
    '채권·보험·보상·심사': 65,
    '손익/리스크관리': 65,
    '보험계리사/손해사정인': 65,
    '채권관리': 65,
    '도서관사서': 66,
    '사서/문서관리': 66,
    '연구소·R&D': 67,
    '전기': 67,
    '기계': 67,
    '전자/반도체': 67,
    '화학/화공/섬유': 67,
    '금속/재료/신소재': 67,
    '유전공학/생명/생물': 67,
    '식품': 67,
    '환경/수질/대기/폐기물': 67,
    '인문/사회과학': 67,
    '광산': 67,
    '임원·CEO': 68,
    '문화·예술·종교': 69,
    '문화/예술/스포츠': 69,
    '종교': 69,
    '특수직': 70,
    '의사·치과·한의사': 71,
    '의사': 71,
    '한의사': 71,
    '치과의사': 71,
    '수의사': 72,
    '약사': 73,
    '약사/한약사': 73,
    '간호사': 74,
    '간호조무사': 75,
    '의료기사': 76,
    '치기공사/치위생사': 76,
    '물리치료사': 76,
    '임상심리사/임상병리사': 76,
    '방사선사': 76,
    '안경사': 76,
    '영양사': 76,
    '의무기록사': 76,
    '응급구조사': 76,
    '사무·원무·코디': 77,
    '보험심사과': 78,
    '의료기타직': 79,
    '간병인': 79,
    '생산·제조·포장·조립': 80,
    '생산/제조': 80,
    '포장/조립': 80,
    '생산관리·품질관리': 81,
    '생산관리': 81,
    '품질관리': 81,
    '공정관리': 81,
    '생산/품질기획': 81,
    '기계·기계설비': 82,
    '기계설계': 82,
    '조달': 82,
    '프로젝트/자원개발': 82,
    '기계/기계설비': 82,
    '금속·금형': 83,
    '금속/금형': 83,
    '비금속·요업·신소재': 84,
    '비금속/요업/신소재': 84,
    '전기·전자·제어': 85,
    '제어': 85,
    '전기설계': 85,
    '공정설계': 85,
    '전기/전자/제어': 85,
    '반도체·디스플레이·LCD': 86,
    '반도체/디스플레이': 86,
    '화학·에너지': 87,
    '화학/에너지': 87,
    '섬유·의류·패션': 88,
    '섬유/의류/패션': 88,
    '바이오·제약·식품': 89,
    '바이오/제약/식품': 89,
    '설계·CAD·CAM': 90,
    '안경·렌즈·광학': 91,
    '안경/렌즈/광학': 91,
    '토목·조경·도시·측량': 92,
    '조경/도시/인프라': 92,
    '건축·인테리어·설계': 93,
    '건축설계': 93,
    '토목설계': 93,
    '건축/설계디자인': 93,
    '전기·소방·통신·설비': 94,
    '배관설계': 94,
    '환경·플랜트': 95,
    '환경/안전/보건(ESH)': 95,
    '현장·시공·감리·공무': 96,
    '시공/감리/공무': 96,
    '안전·품질·검사·관리': 97,
    '안전관리': 97,
    '부동산·개발·경매·분양': 98,
    '감정사/평가사/경매사': 98,
    '부동산/공인중개사': 98,
    '본사·관리·전산': 99,
    '물류·유통·운송': 100,
    '물류/유통/운송': 100,
    '해외영업·무역영업': 101,
    '해외영업': 101,
    '트레이딩': 101,
    '구매·자재·재고': 102,
    '구매/자재/재고': 102,
    '납품·배송·택배': 103,
    '상품기획·MD': 104,
    '상품개발/기획/MD': 104,
    '무역사무·수출입': 105,
    '수출입관리': 105,
    '관세사': 105,
    '운전·기사': 106,
    '중장비·화물': 107,
    '방송연출·PD·감독': 108,
    '방송연출/PD/감독': 108,
    '카메라·조명·미술': 109,
    '카메라/조명/미술': 109,
    '진행·아나운서': 110,
    '진행/아나운서': 110,
    '작가·시나리오': 111,
    '작가/시나리오': 111,
    '기자': 112,
    '연예·엔터테인먼트': 113,
    '프로게이머': 113,
    '배우/모델': 113,
    '연예/엔터테인먼트': 113,
    '공연·무대·스텝': 114,
    '공연/무대/스텝': 114,
    '영화제작·배급': 115,
    '영화제작/배급': 115,
    '광고·카피·CF': 116,
    '광고기획/카피라이터': 116,
    '음악·음향·사운드': 117,
    '음악/음향/사운드': 117,
    '인쇄·출판·편집': 118,
    '인쇄/출판/편집': 118,
    '사진·포토그라퍼': 119,
    '사진/포토그래퍼/카메라기자': 119,
    '유치원·보육': 120,
    '유치원/보육 교사': 120,
    '초중고·특수학교': 121,
    '초중고/특수학교 교사': 121,
    '입시·보습·속셈학원': 122,
    '입시/보습/학원 강사': 122,
    '외국어·어학원': 123,
    '외국어/어학원 강사': 123,
    '학습지·과외·방문': 124,
    '학습지/과외/방문 교사': 124,
    '전문직업·IT강사': 125,
    '전문강사': 125,
    '대학교수·행정직': 126,
    '행정사': 126,
    '대학교수': 126,
    '교직원': 126,
    '교육기획·교재': 127,
    '교육기획/교재개발': 127,
    '학원관리·운영·상담': 128,
    '공무원': 129,
    '장교·군인·부사관': 130,
    '장교/군인/부사관': 130,
    '병역특례': 131,
    '중장년·고령인·실버': 132,
    '장애인·국가유공자': 133,
    '사회복지·요양·봉사': 134,
    '사회복지/요양/봉사': 134
}

with open(os.path.join(DATA_PATH, "data_key15.txt"), 'rt', encoding='UTF8') as f:
    for line in f.readlines():
        if line.startswith('id'):
            pass
        else:
            line = line.split('\t')

            cat = line[1]
            cat = cat.strip().split('//')
            cate = []
            for c in cat:
                c = c.strip()
                count = category_mapping.get(c, 'null')
                cate.append(count)
            category.append(' '.join(map(str, cate)))
            major_task.append(line[2])
            qualification.append(line[3])
            prefer_treatment.append(line[4])
            benefit.append(line[5])
            title.append(line[6])
            company.append(line[7])
            location.append(line[8])
            industry.append(line[9])
            job_type.append(line[10])
            career.append(line[11])
            education.append(line[12])
            salary.append(line[13])
            keyword.append(line[14])

f = open(os.path.join(DATA_PATH, "data_key15(category_numbering).txt"), 'w', encoding='UTF8')
for i in range(len(category) + 1):
    if i == 0:
        f.write('id\t카테고리\t주요업무\t자격요건\t우대사항\t복리후생\t제목\t기업명\t지역\t산업\t근무형태\t경력\t학력\t급여\t키워드\n')
    else:
        f.write(
            f'{i - 1}\t{category[i - 1]}\t{major_task[i - 1]}\t{qualification[i - 1]}\t{prefer_treatment[i - 1]}\t{benefit[i - 1]}\t'
            f'{title[i - 1]}\t{company[i - 1]}\t{location[i - 1]}\t{industry[i - 1]}\t{job_type[i - 1]}\t{career[i - 1]}\t{education[i - 1]}\t'
            f'{salary[i - 1]}\t{keyword[i - 1]}')
